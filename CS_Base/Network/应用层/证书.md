# 数字签名与数字证书

## 非对称加密与对称加密

两种算法：对称加密和非对称加密。

- 对称加密：加密和解密的密钥一样，比如用 123 加密就是用 123 解密，但是实际中密码都是普通数据在互联网传输的，这样一点密码被中间人截取并破解，加密直接被攻破。

- 非对称加密：把密钥分为公钥和私钥，公钥是公开的所有人都可以认领，私钥是保密的只有一个人知道。假设A要发送一封 Email 给 B，他不想让任何其他人在传输中看到 Email 的内容，做法就是使用 B 的公钥对 Email 加密，只有 B 的私钥能够解密（ B 的私钥唯一性保证信件不会泄露）。

  某天出意外了，有黑客冒充 A 给 B 发送 Email，并且也用 B 的公钥加密，导致 B 无法区分这封邮件是否来自 A。怎么办？此时 A 可以用自己的私钥加密，那么 B 收到邮件后如果用 A 的公钥可以解密邮件，那么证明这封信肯定来自于 A。


OK，通过这个例子我想你们基本明白非对称加密了！我总结了下面几点：

- 公钥加密：对内容本身加密，保证不被其他人看到，因为只有私钥可以解密。
- 私钥加密：证明内容的来源，无法保证加密，因为公钥是公开的，所有人都可以用公钥来解密
- 公钥和私钥是配对关系，公钥加密就用私钥解密，反之亦然，用错的密钥来尝试解密会报错。



## 数字签名

接着聊上面发邮件的例子，假设A用自己的私钥对Email加密发送，这存在下面问题：

- 对文件本身加密可能是个耗时过程，比如这封Email足够大，那么私钥加密整个文件以及拿到文件后的解密无疑是巨大的开销。
   数字签名可以解决这个问题：
   1.A先对这封Email执行哈希运算得到hash值简称“摘要”，取名h1
   2.然后用自己私钥对摘要加密，生成的东西叫“数字签名”
   3.把数字签名加在Email正文后面，一起发送给B
   （当然，为了防止邮件被窃听你可以用继续公钥加密，这个不属于数字签名范畴）
   4.B收到邮件后用A的公钥对数字签名解密，成功则代表Email确实来自A，失败说明有人冒充
   5.B对邮件正文执行哈希运算得到hash值，取名h2
   6.B 会对比第4步数字签名的hash值h1和自己运算得到的h2，一致则说明邮件未被篡改。

<img src="image/image-20241029172243089.png" alt="image-20241029172243089" style="zoom:67%;" />

其实就是利用算法（不一定是非对称算法）对原文hash值加密，然后附着到原文的一段数据。数字签名的作用就是验证数据来源以及数据完整性！解密过程则称为数字签名验证。
 几点疑惑：

1. 如果中间人同时篡改了Email正文和数字签名，那B收到邮件无法察觉啊。
    答案：数字签名的生成需要对方私钥，所以数字签名很难被伪造。万一私钥泄漏了呢，不好意思，你私钥都能弄丢了那这篇文章当我白写。（私钥绝对保密不参与传输）
2. 公钥是公开的并且可以自行导入到电脑，如果有人比如C偷偷在B的电脑用自己公钥替换了A的公钥，然后用自己的私钥给B发送Email，这时B收到邮件其实是被C冒充的但是他无法察觉。
    答案：确实存在这种情况！解决办法就是数字证书



## 数字证书

上面第2点描述的安全漏洞根源就是A的公钥很容易被替换！那么数字证书是怎么生成的呢？以及如何配合数字签名工作呢？

1. 首先A去找"证书中心"（certificate authority，简称CA），为公钥做认证。证书中心用自己的私钥，对A的公钥和一些相关信息一起加密，生成"数字证书"（Digital Certificate）：













# 证书签发和验证





# 证书链





# 自签名证书





